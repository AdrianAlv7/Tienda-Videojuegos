{% extends "base.html" %}
{% block title %}Iniciar Sesión{% endblock %}

{% block extra_css %}
<style>

body {
  background: #0a0520 !important;
  font-family: 'Poppins', sans-serif;
}

/* CONTENEDOR GENERAL */
.login-wrapper {
  min-height: calc(100vh - 60px);
  display: flex;
  justify-content: center;
  align-items: center;
  padding: 40px 0;
}

/* CARD PRINCIPAL */
.login-box {
  width: 480px;
  padding: 3.8rem 3rem;
  background: rgba(25, 12, 55, 0.7);
  backdrop-filter: blur(14px);
  -webkit-backdrop-filter: blur(14px);
  border-radius: 24px;
  border: 1px solid rgba(255,255,255,0.15);
  box-shadow:
    0 0 28px rgba(150,60,255,0.45),
    0 0 60px rgba(0,0,0,0.8);

  position: relative;
  overflow: hidden;
  animation: fadeInUp 0.65s ease-out;
}

/* Shine borde */
.login-box::before {
  content: "";
  position: absolute;
  inset: 0;
  border-radius: inherit;
  padding: 2px;
  pointer-events: none; /* ← EL FIX CLAVE */
  background: linear-gradient(
    120deg,
    transparent,
    rgba(196,124,255,0.8),
    transparent
  );
  background-size: 200% 200%;
  animation: borderShine 3.5s linear infinite;

  mask: linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  -webkit-mask:
     linear-gradient(#000 0 0) content-box, linear-gradient(#000 0 0);
  mask-composite: exclude;
  -webkit-mask-composite: xor;
}


@keyframes borderShine {
  0%   { background-position: 200% 0; }
  100% { background-position: -200% 0; }
}

/* LOGO */
.logo-neon {
  width: 150px;
  height: auto;
  margin: 0 auto 1.8rem auto;
  display: block;

  filter:
    drop-shadow(0 0 10px #c47cff)
    drop-shadow(0 0 20px #8b3dff)
    drop-shadow(0 0 35px #8b3dff);

  animation: logoPulse 3s ease-in-out infinite;
}

@keyframes logoPulse {
  0%   { transform: scale(1); }
  50%  { transform: scale(1.05); }
  100% { transform: scale(1); }
}

/* TÍTULO */
.login-box h2 {
  text-align: center;
  font-size: 2.2rem;
  font-weight: 800;
  color: #fff;
  margin-bottom: 0.4rem;
  text-shadow:
    0 0 14px #c47cff,
    0 0 22px #8b3dff;
}

.login-subtitle {
  text-align: center;
  font-size: 0.95rem;
  color: #c8b8ff;
  margin-bottom: 2.2rem;
}

/* INPUTS */
.login-box label {
  font-weight: 600;
  color: #e7d7ff;
  margin-bottom: 4px;
}

.login-box input {
  width: 100%;
  padding: 13px 16px;
  border-radius: 14px;
  background: rgba(255,255,255,0.08);
  border: 1px solid rgba(200,170,255,0.35);
  color: #fff;
  font-size: 1rem;
  transition: 0.25s ease;
}

.login-box input::placeholder {
  color: #b8a6e6;
}

.login-box input:focus {
  border-color: #c47cff;
  box-shadow: 0 0 12px rgba(196,124,255,0.6);
  outline: none;
}

/* BOTÓN LOGIN */
.btn-login {
  margin-top: 1.7rem;
  width: 100%;
  padding: 14px 0;
  border-radius: 14px;
  background: linear-gradient(135deg, #8b3dff, #c47cff);
  color: #fff;
  border: none;
  font-weight: 700;
  font-size: 1.15rem;
  position: relative;
  overflow: hidden;
  cursor: pointer;
  transition: 0.25s ease;
}

.btn-login:hover {
  filter: brightness(1.17);
  box-shadow: 0 0 22px rgba(193,120,255,0.9);
}

.btn-login::after {
  content: "";
  position: absolute;
  top: 0;
  left: -100%;
  width: 70%;
  height: 100%;
  background: linear-gradient(120deg, transparent, rgba(255,255,255,0.4), transparent);
  transform: skewX(-20deg);
  transition: 0.55s;
}

.btn-login:hover::after {
  left: 130%;
}

/* BOTÓN CREAR CUENTA */
.btn-register {
  margin-top: 0.9rem;
  width: 100%;
  padding: 12px 0;
  border-radius: 14px;
  background: transparent;
  color: #d9b8ff;
  border: 1px solid rgba(200,170,255,0.5);
  font-weight: 600;
  font-size: 1rem;
  cursor: pointer;
  transition: 0.25s ease;
}

.btn-register:hover {
  background: rgba(255,255,255,0.08);
  color: #fff;
  box-shadow: 0 0 18px rgba(190,140,255,0.6);
}

/* ALERTAS */
.alert {
  margin-top: 1.2rem;
  border-radius: 12px;
  padding: 10px 15px;
  background: rgba(255,100,160,0.12);
  border: 1px solid rgba(255,120,200,0.3);
  color: #ff84d2;
  box-shadow: 0 0 12px rgba(255,110,190,0.25);
}

/* Animación entrada */
@keyframes fadeInUp {
  0%   { opacity: 0; transform: translateY(16px); }
  100% { opacity: 1; transform: translateY(0); }
}
.register-link {
  display: block;
  margin-top: 1.2rem;
  text-align: center;
  font-weight: 600;
  color: #d9b8ff;
  text-decoration: none;
  transition: 0.25s ease;
  font-size: 0.95rem;
}

.register-link:hover {
  color: #ffffff;
  text-shadow:
    0 0 10px #c47cff,
    0 0 20px #8b3dff;
  transform: scale(1.03);
}


</style>
{% endblock %}

{% block content %}
<div class="login-wrapper">

  <div class="login-box">

    <!-- LOGO -->
    <img src="{{ url_for('static', filename='IMG/logo.png') }}" class="logo-neon" alt="logo">

    <h2>Iniciar Sesión</h2>
    <div class="login-subtitle">
      Accede a tu cuenta para continuar.
    </div>

    <form method="POST">

      <label for="username">Usuario</label>
      <input type="text" id="username" name="username" required autofocus placeholder="Ingresa tu usuario">

      <label for="password" class="mt-3">Contraseña</label>
      <input type="password" id="password" name="password" required placeholder="Ingresa tu contraseña">

      <button type="submit" class="btn-login">Entrar</button>

      <!-- ESTE SÍ FUNCIONA -->
      <a href="{{ url_for('auth.register') }}" class="register-link">
        ¿No tienes cuenta? Regístrate aquí
      </a>


    </form>

    {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}
      {% for category, message in messages %}
      <div class="alert">{{ message }}</div>
      {% endfor %}
    {% endif %}
    {% endwith %}

  </div>

</div>
{% endblock %}
